<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<title>RenÃ©â€™s Telraam</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="icon" href="logo.png">

<link rel="manifest" href='data:application/json,{
  "name":"RenÃ©â€™s Telraam",
  "short_name":"Telraam",
  "start_url":".",
  "display":"standalone",
  "background_color":"#121212",
  "theme_color":"#d32f2f",
  "icons":[
    {"src":"logo.png","sizes":"192x192","type":"image/png"},
    {"src":"logo.png","sizes":"512x512","type":"image/png"}
  ]
}'>

<style>
:root {
  --bg:#f2f2f2; --card:#fff; --text:#000; --accent:#d32f2f;
}
@media (prefers-color-scheme: dark) {
  :root {--bg:#121212; --card:#1e1e1e; --text:#fff;}
}
body {
  background:var(--bg); color:var(--text);
  font-family:system-ui,sans-serif;
  margin:0; padding:10px;
}
.logo {
  display:block;
  margin:10px auto 10px;
  max-width:180px;
}
.card{
  background:var(--card);
  border-radius:12px;
  padding:10px;
  margin-bottom:10px;
  box-shadow:0 2px 6px rgba(0,0,0,.2);
}
table{width:100%;border-collapse:collapse;}
th,td{padding:6px;text-align:center;}
input{width:60px;text-align:center;border-radius:6px;border:1px solid #999;}
button{
  width:100%; padding:12px; font-size:16px;
  border-radius:10px; border:none;
  background:var(--accent); color:white;
  margin-top:5px;
}
#winner{font-size:36px;text-align:center;color:gold;margin:10px 0;}
#verschil{font-size:22px;text-align:center;margin:8px 0;font-weight:bold;}
#history div{padding:5px;border-bottom:1px solid #999;}
canvas{position:fixed;top:0;left:0;pointer-events:none;}
#installBtn{display:none;}

#splash {
  position:fixed;
  inset:0;
  background:var(--bg);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:9999;
}
#splash img {width:180px;}
#splash h2 {margin-top:10px;color:var(--accent);}
</style>
</head>
<body>

<div id="splash">
  <img src="logo.png">
  <h2>RenÃ©â€™s Telraam</h2>
</div>

<img src="logo.png" class="logo">

<button id="installBtn">ðŸ“² Installeer app</button>

<div class="card">
<b>Team Wij</b><br>
<input id="w1" placeholder="Speler 1">
<input id="w2" placeholder="Speler 2"><br><br>
<b>Team Zij</b><br>
<input id="z1" placeholder="Speler 1">
<input id="z2" placeholder="Speler 2">
</div>

<div class="card">
<table>
<thead>
<tr>
<th>R</th>
<th id="tWij">Wij</th>
<th>Roem</th>
<th id="tZij">Zij</th>
<th>Roem</th>
</tr>
</thead>
<tbody id="rows"></tbody>
<tfoot>
<tr>
<th>Punten</th>
<th id="puntenWij">0</th>
<th></th>
<th id="puntenZij">0</th>
<th></th>
</tr>
<tr>
<th>Roem</th>
<th id="roemWij">0</th>
<th></th>
<th id="roemZij">0</th>
<th></th>
</tr>
<tr>
<th>Totaal</th>
<th id="totalWij">0</th>
<th></th>
<th id="totalZij">0</th>
<th></th>
</tr>
</tfoot>
</table>
</div>

<div id="verschil">Verschil: 0</div>
<div id="winner"></div>

<button onclick="nieuwPotje()">Nieuw potje</button>

<div class="card">
<h3>Historie</h3>
<div id="history"></div>
</div>

<canvas id="confetti"></canvas>

<script>
setTimeout(()=>document.getElementById("splash").style.display="none",1500);

let deferredPrompt;
const installBtn=document.getElementById("installBtn");

window.addEventListener("beforeinstallprompt", e=>{
 e.preventDefault();
 deferredPrompt=e;
 installBtn.style.display="block";
});
installBtn.onclick=()=>deferredPrompt.prompt();

const TOTAL=162, ROUNDS=16;
const rows=document.getElementById("rows");

for(let i=1;i<=ROUNDS;i++){
 let tr=document.createElement("tr");
 tr.innerHTML=`
 <td>${i}</td>
 <td><input data-t="w" data-r="${i}"></td>
 <td><input data-t="rw" data-r="${i}"></td>
 <td><input data-t="z" data-r="${i}" readonly></td>
 <td><input data-t="rz" data-r="${i}"></td>`;
 rows.appendChild(tr);
}

const inputs=document.querySelectorAll("input[data-t]");
inputs.forEach(i=>i.oninput=update);
[w1,w2,z1,z2].forEach(i=>i.oninput=()=>{updateNames();save();});

function teamWijNaam(){return (w1.value||"Wij")+" & "+(w2.value||"");}
function teamZijNaam(){return (z1.value||"Zij")+" & "+(z2.value||"");}
function updateNames(){tWij.textContent=teamWijNaam();tZij.textContent=teamZijNaam();}
function q(t,r){return document.querySelector(`[data-t="${t}"][data-r="${r}"]`);}

function update(){
 let tw=0,tz=0,rw=0,rz=0;
 let ingevuld=true;

 for(let i=1;i<=ROUNDS;i++){
  let w=q("w",i), z=q("z",i);
  let val=w.value.trim();
  if(!val) ingevuld=false;

  if(["n","N","p","P"].includes(val)){z.value=TOTAL;w.value=0;}
  else if(!isNaN(val)&&val!==""){z.value=TOTAL-parseInt(val);}

  tw+=+w.value||0;
  tz+=+z.value||0;
  rw+=+q("rw",i).value||0;
  rz+=+q("rz",i).value||0;
 }

 let totaalWij=tw+rw;
 let totaalZij=tz+rz;

 puntenWij.textContent=tw;
 puntenZij.textContent=tz;
 roemWij.textContent=rw;
 roemZij.textContent=rz;
 totalWij.textContent=totaalWij;
 totalZij.textContent=totaalZij;

 let diff=totaalWij-totaalZij;
 verschil.textContent="Verschil: "+(diff>0?"+":"")+diff;

 if(ingevuld) showWinner(totaalWij,totaalZij);
 save();
}

function showWinner(w,z){
 let name=w>z?teamWijNaam():teamZijNaam();
 winner.textContent="ðŸ† Winnaar: "+name+" ðŸ†";
 confetti();
}

function save(){
 let d={w1:w1.value,w2:w2.value,z1:z1.value,z2:z2.value};
 inputs.forEach(i=>d[i.dataset.t+i.dataset.r]=i.value);
 localStorage.setItem("game",JSON.stringify(d));
}

function load(){
 let d=JSON.parse(localStorage.getItem("game")||"{}");
 w1.value=d.w1||""; w2.value=d.w2||"";
 z1.value=d.z1||""; z2.value=d.z2||"";
 inputs.forEach(i=>{let k=i.dataset.t+i.dataset.r;if(d[k])i.value=d[k];});
 updateNames(); update(); loadHistory();
}

function nieuwPotje(){
 if(winner.textContent){
  let hist=JSON.parse(localStorage.getItem("history")||"[]");
  hist.unshift(winner.textContent);
  localStorage.setItem("history",JSON.stringify(hist));
 }
 localStorage.removeItem("game");
 location.reload();
}

function loadHistory(){
 let hist=JSON.parse(localStorage.getItem("history")||"[]");
 history.innerHTML="";
 hist.forEach(h=>{
  let d=document.createElement("div");
  d.textContent=h;
  history.appendChild(d);
 });
}

function confetti(){
 let c=document.getElementById("confetti"),ctx=c.getContext("2d");
 c.width=innerWidth;c.height=innerHeight;
 let p=Array.from({length:200},()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*6}));
 let t=setInterval(()=>{
  ctx.clearRect(0,0,c.width,c.height);
  p.forEach(o=>{
   ctx.beginPath();
   ctx.arc(o.x,o.y,o.r,0,7);
   ctx.fillStyle="hsl("+Math.random()*360+",100%,50%)";
   ctx.fill();
   o.y+=3;if(o.y>c.height)o.y=0;
  });
 },30);
 setTimeout(()=>clearInterval(t),4000);
}

load();
</script>
</body>
</html>

